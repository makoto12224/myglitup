
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>貸切バス年間契約の計算・説明</title>
</head>
<body>

<!-- PRバナー -->
<div style="text-align: center; margin-bottom: 30px;">
  <a href="https://myg20201101.wixsite.com/website" target="_blank" 
     style="display: inline-block; background-color: #ff9800; color: white; padding: 15px 25px; font-size: 18px; font-weight: bold; text-decoration: none; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
    エクセルで簡単！運送引受書（運賃計算機能付き）はこちらをクリック
  </a>
</div>

<!-- 説明・計算例部分（すでに整ったHTML） -->
<div style="font-family: Arial, sans-serif; background-color: #f5faff; color: #333; padding: 20px; max-width: 900px; margin: auto;">
  <h1 style="color: #2a7ab9; border-bottom: 3px solid #2a7ab9; padding-bottom: 10px;">200日×実働率の計算方法</h1>
  <div style="background-color: #ffffff; padding: 15px; margin-bottom: 20px; border-left: 5px solid #2a7ab9; box-shadow: 0 0 10px rgba(0,0,0,0.05);">
    <h2 style="color: #2a7ab9;">1. 「200日×実働率」方式とは？</h2>
    <p>年間契約の運行日数が200日など、特定の日数で契約する場合に使われる計算方法です。この場合も<strong>実働率を掛けて、実際に運賃計算の基礎となる日数を算出</strong>します。</p>
    <p>実働率はバス会社の前年度実績や運輸局の平均値の範囲内で決定されます。</p>
  </div>
  <div style="background-color: #ffffff; padding: 15px; margin-bottom: 20px; border-left: 5px solid #2a7ab9; box-shadow: 0 0 10px rgba(0,0,0,0.05);">
    <h2 style="color: #2a7ab9;">2. 計算手順</h2>
    <div style="color: #1d6f42; font-weight: bold; margin-top: 10px;">ステップ①：実働日数の計算</div>
    <div style="background-color: #e6f4ea; border-left: 5px solid #1d6f42; padding: 10px; margin: 10px 0; font-family: monospace;">
      実働日数 = 年間運行日数 × 実働率<br>
      例：200日 × 0.581 = 116.2 → <strong>116日（切捨て）</strong>
    </div>
    <div style="color: #1d6f42; font-weight: bold; margin-top: 10px;">ステップ②：年間契約運賃の計算</div>
    <div style="background-color: #e6f4ea; border-left: 5px solid #1d6f42; padding: 10px; margin: 10px 0; font-family: monospace;">
      年間契約運賃 = 1日当たり運賃 × 実働日数<br>
      例：100,000円 × 116日 = <strong>11,600,000円</strong>
    </div>
    <div style="color: #1d6f42; font-weight: bold; margin-top: 10px;">ステップ③：運行可能日数の算出</div>
    <div style="background-color: #e6f4ea; border-left: 5px solid #1d6f42; padding: 10px; margin: 10px 0; font-family: monospace;">
      運行可能日数 = 実働日数 × 1.4<br>
      例：116日 × 1.4 = 162.4 → <strong>162日（切捨て）</strong>
    </div>
  </div>
  <div style="background-color: #ffffff; padding: 15px; margin-bottom: 20px; border-left: 5px solid #2a7ab9; box-shadow: 0 0 10px rgba(0,0,0,0.05);">
    <h2 style="color: #2a7ab9;">3. ポイントと注意点</h2>
    <ul style="padding-left: 20px;">
      <li>小数点以下は<strong>切り捨て</strong>（実働日数・運行可能日数ともに）。</li>
      <li>運行可能日数を超えた場合は<strong>追加運賃</strong>が必要。</li>
      <li>実働率は「<strong>バス会社実績</strong>」と「<strong>運輸局平均値</strong>」の間で協議して決定。</li>
    </ul>
  </div>
  <div style="background-color: #ffffff; padding: 15px; border-left: 5px solid #2a7ab9; box-shadow: 0 0 10px rgba(0,0,0,0.05);">
    <h2 style="color: #2a7ab9;">4. まとめ：計算例</h2>
    <table style="width: 100%; border-collapse: collapse;">
      <tr style="background-color: #2a7ab9; color: #fff;">
        <th style="padding: 8px; border: 1px solid #ccc;">項目</th>
        <th style="padding: 8px; border: 1px solid #ccc;">計算式・内容</th>
        <th style="padding: 8px; border: 1px solid #ccc;">例</th>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #ccc;">実働日数</td>
        <td style="padding: 8px; border: 1px solid #ccc;">200日 × 58.1％（切捨て）</td>
        <td style="padding: 8px; border: 1px solid #ccc;">116日</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #ccc;">年間契約運賃</td>
        <td style="padding: 8px; border: 1px solid #ccc;">100,000円 × 116日</td>
        <td style="padding: 8px; border: 1px solid #ccc;">11,600,000円</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #ccc;">運行可能日数</td>
        <td style="padding: 8px; border: 1px solid #ccc;">116日 × 1.4（切捨て）</td>
        <td style="padding: 8px; border: 1px solid #ccc;">162日</td>
      </tr>
    </table>
  </div>
</div>

<!-- フッター案内 -->
<div style="margin-top: 40px; padding: 15px; background-color: #f0f8ff; border-left: 5px solid #2196f3; font-size: 16px; max-width: 900px; margin: 40px auto;">
  と、いろいろ書いてきましたが、上記に簡単に計算できるアプリを記載しておきます。<br>
  ぜひご活用ください。<br><br>
  <strong>でも、きちんと最後は手計算で確認してくださいね＾＾</strong>
</div>

<div style="font-family: Arial, sans-serif; background-color: #ffffff; padding: 20px; max-width: 900px; margin: auto;">
  <h1 style="text-align: center; font-size: 24px;">貸切バス年間契約の計算</h1>

  <label for="targetDays">運行したい日数（日数）</label>
  <input type="number" id="targetDays" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;">

  <label for="timeRate">時間制料金単価（円/時間）</label>
  <input type="number" id="timeRate" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;">

  <label for="distanceRate">距離制料金単価（円/km）</label>
  <input type="number" id="distanceRate" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;">

  <label for="deadheadDistance">回送距離（km）</label>
  <input type="number" id="deadheadDistance" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;">

  <label for="realDistance">実車距離（km）</label>
  <input type="number" id="realDistance" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;">

  <label for="deadheadTime">回送時間（hh:mm）</label>
  <input type="text" id="deadheadTime" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;">

  <label for="realTime">実車時間（hh:mm）</label>
  <input type="text" id="realTime" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;">

  <label for="workRate">実働率（小数第3位まで）</label>
  <input type="number" step="0.001" id="workRate" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;">

  <button onclick="calculateAnnualContract()" style="display: block; width: 100%; padding: 10px; font-size: 18px; margin: 20px 0; cursor: pointer;">計算する</button>

  <div id="result" style="font-size: 18px; margin-top: 20px; white-space: pre-line; background-color: #f0f0f0; padding: 20px; border-radius: 8px;"></div>
</div>

<script>
function calculateAnnualContract() {
  const targetDays = Number(document.getElementById('targetDays').value);
  const timeRate = Number(document.getElementById('timeRate').value);
  const distanceRate = Number(document.getElementById('distanceRate').value);
  const deadheadDistance = Number(document.getElementById('deadheadDistance').value);
  const realDistance = Number(document.getElementById('realDistance').value);
  const deadheadTime = document.getElementById('deadheadTime').value;
  const realTime = document.getElementById('realTime').value;
  const workRate = Number(document.getElementById('workRate').value);

  if (!targetDays || !timeRate || !distanceRate || !deadheadDistance || !realDistance || !deadheadTime || !realTime || !workRate) {
    alert('すべての項目を正しく入力してください。');
    return;
  }

  function timeToHours(timeStr) {
    const [h, m] = timeStr.split(':').map(Number);
    let hours = h;
    if (m >= 30) {
      hours += 1;
    }
    return hours;
  }

  let totalHours = timeToHours(deadheadTime) + timeToHours(realTime) + 2;
  if (totalHours < 5) totalHours = 5;

  const timeCharge = totalHours * timeRate;
  const totalDistance = Math.ceil((deadheadDistance + realDistance) / 10) * 10;
  const distanceCharge = totalDistance * distanceRate;
  const busCharge = timeCharge + distanceCharge;

  const baseWorkDays = Math.floor(targetDays * workRate);
  const contractDays = Math.floor(baseWorkDays * 1.4);
  const baseCost = busCharge * baseWorkDays;

  let missingDays = targetDays - contractDays;
  if (missingDays < 0) missingDays = 0;
  const additionalCost = missingDays * busCharge;
  const totalCost = baseCost + additionalCost;

  const resultText = `【バス料金計算】\n` +
    `時間制料金: ${totalHours}時間 × ${timeRate}円 = ${timeCharge.toLocaleString()}円\n` +
    `距離制料金: ${totalDistance}km × ${distanceRate}円 = ${distanceCharge.toLocaleString()}円\n` +
    `バス料金合計: ${busCharge.toLocaleString()}円\n\n` +
    `【年間契約計算】\n` +
    `運行基準日数: ${targetDays}日 × 実働率${workRate.toFixed(3)} = ${baseWorkDays}日\n` +
    `${baseWorkDays}日 × 1.4 = ${contractDays}日\n\n` +
    `→ ${baseCost.toLocaleString()}円で${contractDays}日走れる\n` +
    `→ 追加 ${missingDays}日分: ${additionalCost.toLocaleString()}円\n\n` +
    `【最終結果】\n` +
    `${baseCost.toLocaleString()}円 + ${additionalCost.toLocaleString()}円 = ${totalCost.toLocaleString()}円で${targetDays}日走れる`;

  document.getElementById('result').innerText = resultText;
}
</script>
</body></html>