<meta charset="UTF-8">
<title></title>
<!-- 検索エンジンにインデックスさせない --><meta name="robots" content="noindex, nofollow"><meta name="googlebot" content="noindex, nofollow"><!-- PRバナー -->
<div style="text-align: center; margin-bottom: 30px;"><a href="https://myg20201101.wixsite.com/website" style="display: inline-block; background-color: #ff9800; color: white; padding: 15px 25px; font-size: 18px; font-weight: bold; text-decoration: none; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);" target="_blank">エクセルで簡単！運送引受書（運賃計算機能付き）はこちらをクリック</a></div>
<!-- 計算フォーム -->

<div style="font-family: Arial, sans-serif; background-color: #ffffff; padding: 20px; max-width: 900px; margin: auto;">
<h1 style="text-align: center; font-size: 24px;">貸切バス年間契約の計算</h1>
<label for="targetDays">運行したい日数（日数）</label> <input id="targetDays" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;" type="number" /> <label for="timeRate">時間制料金単価（円/時間）</label> <input id="timeRate" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;" type="number" /> <label for="distanceRate">距離制料金単価（円/km）</label> <input id="distanceRate" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;" type="number" /> <label for="deadheadDistance">回送距離（km）</label> <input id="deadheadDistance" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;" type="number" /> <label for="realDistance">実車距離（km）</label> <input id="realDistance" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;" type="number" /> <label for="deadheadTime">回送時間（hh:mm）</label> <input id="deadheadTime" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;" type="text" /> <label for="realTime">実車時間（hh:mm）</label> <input id="realTime" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;" type="text" /> <label for="workRate">実働率（小数第3位まで）</label> <input id="workRate" step="0.001" style="width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;" type="number" /><button onclick="calculateAnnualContract()" style="display: block; width: 100%; padding: 10px; font-size: 18px; margin: 20px 0; cursor: pointer;">計算する</button>

<div id="result" style="font-size: 18px; margin-top: 20px; white-space: pre-line; background-color: #f0f0f0; padding: 20px; border-radius: 8px;">&nbsp;</div>
</div>
<script>
function calculateAnnualContract() {
  const targetDays = Number(document.getElementById('targetDays').value);
  const timeRate = Number(document.getElementById('timeRate').value);
  const distanceRate = Number(document.getElementById('distanceRate').value);
  const deadheadDistance = Number(document.getElementById('deadheadDistance').value);
  const realDistance = Number(document.getElementById('realDistance').value);
  const deadheadTime = document.getElementById('deadheadTime').value;
  const realTime = document.getElementById('realTime').value;
  const workRate = Number(document.getElementById('workRate').value);

  if (!targetDays || !timeRate || !distanceRate || !deadheadDistance || !realDistance || !deadheadTime || !realTime || !workRate) {
    alert('すべての項目を正しく入力してください。');
    return;
  }

  function timeToHours(timeStr) {
    const [h, m] = timeStr.split(':').map(Number);
    let hours = h;
    if (m >= 30) hours += 1;
    return hours;
  }

  let totalHours = timeToHours(deadheadTime) + timeToHours(realTime) + 2;
  if (totalHours < 5) totalHours = 5;

  const timeCharge = totalHours * timeRate;
  const totalDistance = Math.ceil((deadheadDistance + realDistance) / 10) * 10;
  const distanceCharge = totalDistance * distanceRate;
  const busCharge = timeCharge + distanceCharge;

  const baseWorkDays = Math.floor(targetDays * workRate);
  const contractDays = Math.floor(baseWorkDays * 1.4);
  const baseCost = busCharge * baseWorkDays;

  let missingDays = targetDays - contractDays;
  if (missingDays < 0) missingDays = 0;
  const additionalCost = missingDays * busCharge;
  const totalCost = baseCost + additionalCost;

  const resultText = `【バス料金計算】\n` +
    `時間制料金: ${totalHours}時間 × ${timeRate}円 = ${timeCharge.toLocaleString()}円\n` +
    `距離制料金: ${totalDistance}km × ${distanceRate}円 = ${distanceCharge.toLocaleString()}円\n` +
    `バス料金合計: ${busCharge.toLocaleString()}円\n\n` +
    `【年間契約計算】\n` +
    `運行基準日数: ${targetDays}日 × 実働率${workRate.toFixed(3)} = ${baseWorkDays}日\n` +
    `${baseWorkDays}日 × 1.4 = ${contractDays}日\n\n` +
    `→ ${baseCost.toLocaleString()}円で${contractDays}日走れる\n` +
    `→ 追加 ${missingDays}日分: ${additionalCost.toLocaleString()}円\n\n` +
    `【最終結果】\n` +
    `${baseCost.toLocaleString()}円 + ${additionalCost.toLocaleString()}円 = ${totalCost.toLocaleString()}円で${targetDays}日走れる`;

  document.getElementById('result').innerText = resultText;
}
</script>